# -*- coding: utf-8 -*-
"""Use google sheets api using python.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1NF0d5hjhov8bnsnLXgW1jOnC8mIHpg0h

[Read and write Google Sheet with 5 lines of Python code
](https://www.codeforests.com/2020/11/22/gspread-read-write-google-sheet/)

[Read and Write Data in Google Sheets using Python and the Google Sheets API
](https://aryanirani123.medium.com/read-and-write-data-in-google-sheets-using-python-and-the-google-sheets-api-6e206a242f20)

[Pandaså¥—ä»¶è®€å¯«Google Sheetsè©¦ç®—è¡¨è³‡æ–™ç§˜è¨£
](https://www.learncodewithmike.com/2021/06/pandas-and-google-sheets.html)

[Get Google Sheets data with Python in 1 minute ğŸ‘†
](https://www.youtube.com/watch?v=2IYJ3B1ymA8)

[Python Google Sheets API Tutorial 
](https://www.youtube.com/watch?v=cnPlKLEGR7E)

<ul>
  <li>å•Ÿç”¨Google Sheets API</li>
  <li>å»ºç«‹Google Sheetsæ†‘è­‰</li>
  <li>å»ºç«‹Google Sheetsè©¦ç®—è¡¨</li>
  <li>Pandaså¯«å…¥Google Sheetsè©¦ç®—è¡¨</li>
  <li>Pandasè®€å–Google Sheetsè©¦ç®—è¡¨</li>
</ul>

å¦‚åœ¨æœ¬åœ°é›»è…¦ä¸Šä½¿ç”¨éœ€åœ¨çµ‚ç«¯æ©Ÿå®‰è£

$ pip install pandas

$ pip install gspread

$ pip install google-auth
"""

from google.oauth2.service_account import Credentials    #å®‰è£Google APIsé©—è­‰
import gspread                                           #å®‰è£Google Sheets Python API
import pandas as pd                                      #å®‰è£pandaså¥—ä»¶

"""write to a sheet"""

scope = ['https://www.googleapis.com/auth/spreadsheets'] #Googleæ“æœ‰è¨±å¤šçš„é›²ç«¯æœå‹™ï¼Œæ‰€ä»¥éœ€è¦å®šç¾©å­˜å–çš„Scope(ç¯„åœ)ï¼Œä¹Ÿå°±æ˜¯Google Sheets(è©¦ç®—è¡¨)
 
creds = Credentials.from_service_account_file("gs_credentials.json", scopes=scope)#å°‡JSONæ†‘è­‰æª”ä¸Šå‚³è‡³colabï¼Œå‚³å…¥google-authå¥—ä»¶çš„Credentailsæ¨¡çµ„(Module)ï¼Œä¾†å»ºç«‹æ†‘è­‰ç‰©ä»¶
gs = gspread.authorize(creds)

sheet = gs.open_by_url('https://docs.google.com/spreadsheets/d/1XebW4ZryhCO2MEjZ3tKf0F7wgZBZFbTR_cJ5_zbDPCk/edit?usp=sharing')  #å‘¼å«gspreadæ¨¡çµ„(Module)çš„open_by_url()æ–¹æ³•(Method)ï¼Œå‚³å…¥Google Sheetsè©¦ç®—è¡¨çš„ç¶²å€
worksheet = sheet.get_worksheet(0) #é¸æ“‡å·¥ä½œè¡¨

df = pd.DataFrame({'Yes': [10, 20], 'No': [30, 40]}) #å»ºç«‹ä¸€çµ„è¡¨æ ¼

worksheet.update([df.columns.values.tolist()] + df.values.tolist()) #å¯«å…¥å…¨éƒ¨æª”æ¡ˆ

"""read sheet data"""

new_df = pd.DataFrame(worksheet.get_all_records()) #ç²å–è©¦ç®—è¡¨å…¨éƒ¨çš„è³‡æ–™
print(new_df)

"""English word practice"""

scope = ['https://www.googleapis.com/auth/spreadsheets'] 
 
creds = Credentials.from_service_account_file("gs_credentials.json", scopes=scope)
gs = gspread.authorize(creds)
 
sheet = gs.open_by_url('https://docs.google.com/spreadsheets/d/1EeAt7d8jy2M_U0rXd6cwRVdhzAmzR6iXakzMExfNsJw/edit?usp=sharing') 
worksheet = sheet.get_worksheet(0) 

df = pd.DataFrame() 

new_df = pd.DataFrame(worksheet.get_all_records())

print(new_df)

import random


ch = []
en = []

for i in range(len(new_df['DAY1 è¾¦å…¬é”äºº'])):
  
  ch.append(new_df['DAY1 ç¿»è­¯'][i])
  en.append(new_df['DAY1 è¾¦å…¬é”äºº'][i])
  #print(f"{new_df['DAY1 è¾¦å…¬é”äºº'][i]:15}{new_df['DAY1 ç¿»è­¯'][i]}")'

en_last = [x.strip() for x in en if x.strip()!='']
ch_last = [x.strip() for x in ch if x.strip()!='']


t=0
while True:
  i = random.randint(0, len(ch))
  if t == i :
      i = random.randint(0, len(ch))
  
  s = str(input(f"è«‹è¼¸å…¥å°æ‡‰çš„è‹±æ–‡(è¼¸å…¥çµæŸå³å¯çµæŸç¨‹å¼) {ch_last[i],en_last[i]}=>ï¼š"))
  if s == "çµæŸ" : break
  elif en_last[i] == s: print('\033[1;32;1m ç­”å°äº†ï¼ \033[0m')
  else: print('\033[1;31;1m ç­”éŒ¯äº†ï½ \033[0m')
  t = i